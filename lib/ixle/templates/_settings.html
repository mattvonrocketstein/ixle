{%extends "layout.html"%}

{%block body%}
<script>{%include "javascript/base.js"%}</script>

<h3>Dynamic settings (from database)</h3>
<hr/>
<table>
  {%for setting in settings %}
  <tr>
    <td>{{setting.name}}</td>
    <td>
      <form method=GET id="setting_{{setting.name}}">
        <input id=vsetting_{{setting.name}} type=text value="{{setting.value}}">
        <input type=submit>
      </form>
      <script>
        $('#setting_{{setting.name}}').submit(function(){
        var pdata = { name:'{{setting.name}}',
                      value:$('#vsetting_{{setting.name}}').attr('value')};
        $.ajax({
        url: '{{this_url}}',
        type: "POST",
        data: pdata,
        dataType: "html",
        beforeSend: function(){
        flash('sending data.. '+json2string(pdata))
        },
        error: function(){flash('error saving.. check console');},
        success: function() {
        flash('finished storing data.  (reload the page to see updates)')
        $('#loading').hide();
        }
        });
        return false; //prevent default submission.
        });
      </script>
    </td>
  </tr>
  {%endfor%}
</table>
<hr/>
<h3>Config (from .ini) </h3>
{%endblock%}
