{%extends "layout.html"%}
{%block main_menu %}
<table width=100%>
  <tr>
    <td>
      <span id=dir_view_widget>
        <small>
          (dir_view_widget not loaded)
        </small>
      </span>
      <strong>
        {{item.fname}}
      </strong><br/>
      <!--div style="margin-left:10px">
          stuff stuff stuff
          </div-->
    </td>
    <td align=right>
      <a href="file://{{item.abspath}}">link for file://</a><strong> | </strong>
      <a href="{{this_url}}?_={{item.id}}">this url</a><strong> | </strong>
      <div id=agents_widget></div><script>$(document).ready(function(){$('#agents_widget').load('/_agents')})</script>
    </td>
  </tr>
</table><hr/>
{%endblock%}


{%block body%}
<div style="margin-left:10px;">
  <table>
    <tr>
      <td><strong>File Information:<a href=#></strong>
      </td>
      <td id=disconnection_notification>
        <script>
          $(document).ready(function(){$('#disconnection_notification').load('/widgets/is_available',{'_':'{{item.abspath}}'})});
        </script>
      </td>
    </tr>
  </table>
  <table style="margin-left:15px;width:100%">
    <tr>
      <td><strong><small>size</small></strong></td>
      <td style="padding-left:10px">
        <small><a href="/fext?_={{item.fext}}">
          {%if item.size_mb > 1%}
          {{item.size_mb}} MB
          {%else%}
          {{item.size}}
          {%endif%}
        </a><small>
      </td>
    </tr>
    <tr>
      <td><b>file extension</b></td>
            <td style="padding-left:10px">
        <a href="/fext?_={{item.fext}}">{{item.fext}}</a></td>
    </tr>
    <tr>
      <td><b>mime-type</b></td>
       <td style="padding-left:10px"><small>{{item.mime_type}}</small></td>
    </tr>
    <tr>
      <td><b>file type</b></td>
      <td style="padding-left:10px"><small>{{item.file_type}}</small></td>
    </tr>
    <tr>
      <td><b>file magic</b></td>
      <td style="padding-left:10px"><small>{{' '.join(item.file_magic)}}</small></td>
    </tr>
    <tr>
      <td><b>t_mod</b></td>
       <td>{{item.t_mod|naturaltime}}</td>
    </tr>
    <tr>
      <td><b>t_last_mod</b></td>
      <td>{{item.t_last_mod|naturaltime}}</td>
    </tr>
    <tr>
      <td><b>t_seen</b></td>
      <td>{{item.t_seen|naturaltime}}</td>
    </tr>
    <tr>
      <td><b>t_last_seen</b></td>
      <td>{{item.t_last_seen|naturaltime}}</td>
    </tr>
    <tr>
      <td><strong><small>is_movie</small></strong></td>
      <td>{{item.is_movie}}</td></tr>
  </table>

  {# begin heuristics #}
  <hr/>
  <strong>Heuristics:</strong>
  <div style="margin-top:5px;margin-left:15px;">
    <table>
      {% for fxn_name,result in heuristics.items() %}
      {%if result!=None%}
      <tr>
        <td><strong><small>{{fxn_name}}</small></strong></td>
        <td><small><small>{{result}}</small></small></td>
      </tr>
      {%endif%}
    {%endfor%}
      <tr>
        <td><strong>
            <small>negative answers for:</small></strong></td>
        <td>
          {% for fxn_name,result in heuristics.items() %}
          {%if result==None%}
          <small>{{fxn_name}}</small> <strong>|</strong>
          {%endif%}
          {%endfor%}
        </td>
      </tr>
    </table>
  </div>

  {# begin body #}
  <hr/>
  <strong>body:</strong>
  <div style="margin-top:5px;margin-left:15px;">
    {{item.body}}
  </div>

  {#% include "item_detail_genre.html" %#}

<hr/>
  <strong>Tags:</strong> <small><a href="{{this_url}}?_={{item.id}}&reset_tags=1">reset</a></small>
  <div style="margin-top:5px;margin-left:15px;">
    <table>
      {% for k,v in item.tags.items()%}
    <tr>
      <td>
        <strong><small>{{k}}</small></strong>
      </td>
      <td>
        <small><small>{{v}}</small></small>
      </td>
    </tr>
    {%endfor%}</table>
  </div>
</div>
<script>
  {%with abspath=item.abspath%}{%include "javascript/dir_view_widget.js"%}{%endwith%}
</script>
{% endblock %}


{%block footer_right%}
<a href="/delete?from=db&_={{item.id}}">
  delete entry (from database)</a> <b>|</b>
<a href=#>delete file (from disk)</a> (NIY) <b>|</b>
<a href=#>show file</a> (NIY)<b>|</b>
<a href="/suggest?_={{item.abspath}}">suggest name</a> (NIY)
{%endblock%}
