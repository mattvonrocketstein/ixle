{% import 'ixle_macros.html' as macros %}
{%extends "layout.html"%}

{%block main_menu %}
<table width=100%>
  <tr>
    <td>
      <span id=dir_view_widget>
        <small>
          (dir_view_widget not loaded)
        </small>
      </span>
      <strong>
        {{item.fname}}
      </strong>
      {%include "item/to_clipboard.html"%}
      <br/>
    </td>
    <td align=right>
      <table>
        <tr>
          <td>
            <a href="/view?_{{item.path}}">view</a>
            <strong> | </strong>
            <a href="{{this_url}}?_={{item.path}}">thisUrl</a>
            <strong> | </strong>
            <a href="/rename?_={{_}}">rename</a>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table><hr/>
{%endblock%}


{%block body%}
<div id=block_body style="margin-left:10px;">
  <table>
    <tr>
      <td><strong>File Information:<a href=#></a></strong>
      </td>
      <td id=disconnection_notification>
        <small>
          <script>
            $(document).ready(function(){$('#disconnection_notification').load('/widgets/is_available',{'_':'{{item.path}}'})});
        </script></small>
      </td>
    </tr>
  </table>
  <table style="margin-left:15px;width:100%">
    <tr>
      <td><strong><small>size</small></strong></td>
      <td>
        <small>
          {%if item.size==None %}
          {{macros.id_calc_link('sizer')}}
          {%else%}
          {%if item.size_mb > 1%}
          {{item.size_mb}} MB
          {%else%}
          {{item.size}}
          {%endif%}
          {%endif%}
          <small>
      </td>
    </tr>
    <tr>
      <td><b>file extension</b></td>
      <td>
        <a href="/fext?_={{item.fext}}">{{item.fext}}</a></td>
    </tr>
    <tr>
      <td><b>mime-type</b></td>
      <td><small>{{item.mime_type}}</small></td>
    </tr>
    <tr>
      <td><b>file type</b></td>
      <td>
        <small>
          {% if item.file_type==None%}
          {{macros.id_calc_link('typer')}}
          {%else%}
          <a href="/file_type?_={{item.file_type}}">{{item.file_type}}</a>
          {%endif%}
        </small>
      </td>

    </tr>
    <tr>
      <td><b>file magic</b></td>
      <td><small>{{' '.join(item.file_magic)}}</small></td>
    </tr>
    <tr>
      <td><b>t_mod</b></td>
      <td>{{item.t_mod|naturaltime}}</td>
    </tr>
    <tr>
      <td><b>t_last_mod</b></td>
      <td>{{item.t_last_mod|naturaltime}}</td>
    </tr>
    <tr>
      <td><b>t_seen</b></td>
      <td>{{item.t_seen|naturaltime}}</td>
    </tr>
    <tr>
      <td><b>t_last_seen</b></td>
      <td>{{item.t_last_seen|naturaltime}}</td>
    </tr>
    <tr>
      <td><strong><small>is_movie</small></strong></td>
      <td>{{item.is_movie}}</td></tr>
  </table>

  {# begin heuristics #}
  {%include "item/heuristics.html"%}

  {# begin body #}
  <hr/>
  <strong>body:</strong>
  <div style="margin-top:5px;margin-left:15px;">
    {{item.body}}
  </div>

  {#% include "item_detail_genre.html" %#}

  <hr/>
  <strong>Tags:</strong>
  <small>
    <a href="{{this_url}}?_={{item.path}}&reset_tags=1">reset</a>
  </small>
  <div style="margin-top:5px;margin-left:15px;">
    <table>
      {% for k,v in item.tags.items()%}
      <tr>
        <td>
          <strong><small>{{k}}</small></strong>
        </td>
        <td>
          <small><small>{{v}}</small></small>
        </td>
      </tr>
      {%endfor%}</table>
  </div>
</div>
<script>
  {%with abspath=item.path%}{%include "javascript/dir_view_widget.js"%}{%endwith%}
</script>
{% endblock %}


{%block footer_right%}
<a href="/delete?from=db&_={{item.path}}">
  delete entry (from database)
</a> <b>|</b>
<a href=#>delete file (from disk)</a> (NIY) <b>|</b>
<a href=#>show file</a> (NIY)<b>|</b>
<a href="/suggest?_={{item.path}}">suggest name</a> (NIY)
{%endblock%}
