{%extends "search.html"%}

{%block query_helo%}
<table width=100%>
  <tr><td>
      Browsing: {{_}}"<i><span id=dir_view_widget>{{query}}</span></i>"
    </td>
    <td align=right>
      {%include "widgets/fs_disconnect_notification.html"%}
      <small>
        <a href=#>index directory</a> |
        <a href="javascript:post_to_api('unindex')">unindex directory</a> |
        <a href="javascript:interstitial_api_call('rename_dir')">rename dir recursively</a>
        <!--a href="/api?action=kill_directory&_={{query}}">kill directory</a-->
      </small>
    </td>
  </tr>
</table>
{%endblock%}

{% block body %}
<div id=block_body style="margin-left:10px;width:100%">
  {%if files%}
  <strong>Files:</strong> <small><i>(according to filesystem)</i></small>
  <div style="margin-left:15px;">
       {%for short_name, apath in files.items()%}
       <small>
         <a href="javascript:show_detail({{apath|escapejs}})">{{short_name}}</a>
       </small>
       <strong>|</strong>
       {%endfor%}
  </div>
  <hr/>
  {%endif%}
  {%if subddirs%}
  <strong>Subdirs::</strong>
  <div style="margin-left:15px;">
       {%for name,fullpath in subddirs%}
       <small>
         <a href="/browser?_={{fullpath}}">{{name}}</a>
       </small>
       <strong>|</strong>
       {%endfor%}
  </div>
  <hr/>
{%endif%}
</div>
{{super()}}
{%endblock%}

{%block footer_left%}

<table>
  <tr>
    <td><strong>run:</strong></td>
    <td>
      {%for agent in agent_types%}
      <a href="/spawn?agent={{agent}}&path={{query}}">{{agent}}</a>
      <strong>|</strong>
      {%endfor%}
    </td>
  <tr>
  <tr>
    <td><strong>force-run:</strong></td>
    <td>
      {%for agent in agent_types%}
      <a href="/spawn?force=1&agent={{agent}}&path={{query}}">{{agent}}</a>
      <strong>|</strong>{%endfor%}
    </td>
  <tr>
</table>

<script>
  {%with abspath=query%}{%include "javascript/dir_view_widget.js"%}{%endwith%}
  {%include "javascript/show_detail.js"%}
  {%include "javascript/post_to_api.js" %}
</script>
{%endblock%}
